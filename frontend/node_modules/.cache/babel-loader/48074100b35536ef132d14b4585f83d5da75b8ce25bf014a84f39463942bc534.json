{"ast":null,"code":"var _jsxFileName = \"D:\\\\projects\\\\ProductCatalog\\\\frontend\\\\src\\\\components\\\\ProductDetail.js\",\n  _s = $RefreshSig$();\n/**\r\n * Component that displays the product details page. This component also displays\r\n * 3 recommended products for the current product being viewed, and clicking on\r\n * any of the recommendations will take you to the corresponding product's details page,\r\n * and update product similarities.\r\n * \r\n * @component\r\n */\nimport React, { useState, useEffect } from \"react\";\nimport ProductForm from \"./ProductForm\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ProductDetail({\n  productId,\n  onBack,\n  onSelectRecommendation\n}) {\n  _s();\n  const [product, setProduct] = useState(null);\n  const [recommendations, setRecommendations] = useState([]);\n  const [displayEditForm, setDisplayEditForm] = useState(false);\n\n  // fetches a product's details along with its recommendations\n  async function fetchDetails() {\n    const res = await fetch(`/products/${productId}/?raw=0`);\n    const data = await res.json();\n    setProduct(data.product);\n    setRecommendations(data.recommendations);\n  }\n\n  // fetch product details on mount, unless productId is null\n  useEffect(() => {\n    if (productId) {\n      fetchDetails();\n    } else {\n      setProduct(null);\n    }\n  }, [productId]);\n\n  // Updates similarity scores, then loads the product details for the\n  // recommended product that was just clicked on.\n  const handleRecommendationClick = async clickedId => {\n    const otherIds = recommendations.filter(rec => rec.id !== clickedId).map(rec => rec.id);\n    await fetch(\"/similarity/update/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        current_product_id: productId,\n        clicked_product_id: clickedId,\n        other_product_ids: otherIds\n      })\n    });\n    onSelectRecommendation(clickedId);\n  };\n\n  // Handler for product deletion\n  const deleteProduct = async productId => {\n    try {\n      const res = await fetch(`/products/${productId}/delete/`, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n    } catch (err) {\n      console.error(`Error deleting product ${productId}`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 20\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onBack,\n      children: \"\\u2190 Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        setDisplayEditForm(true);\n      },\n      style: {\n        marginLeft: 10\n      },\n      children: \"Edit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: async () => {\n        const isConfirmed = window.confirm(`Are you sure you want to delete the product: ${product.name}?`);\n        if (isConfirmed) {\n          await deleteProduct(productId);\n          onBack();\n        }\n      },\n      style: {\n        marginLeft: 10\n      },\n      children: \"Delete\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this), product ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: product.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Category:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 24\n        }, this), \" \", product.category.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Tags:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 24\n        }, this), \" \", product.tags.map(t => t.name).join(\", \")]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Recommended Products\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: recommendations.map(rec => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRecommendationClick(rec.id),\n            children: rec.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 33\n          }, this)\n        }, rec.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }, this), displayEditForm && productId && /*#__PURE__*/_jsxDEV(ProductForm, {\n      mode: \"edit\",\n      productId: productId,\n      onClose: () => {\n        setDisplayEditForm(false);\n      },\n      onSave: () => {\n        setDisplayEditForm(false);\n        fetchDetails();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n}\n_s(ProductDetail, \"Y6RM28ccSuEFEUefjwVpqFO6mN0=\");\n_c = ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["React","useState","useEffect","ProductForm","jsxDEV","_jsxDEV","Fragment","_Fragment","ProductDetail","productId","onBack","onSelectRecommendation","_s","product","setProduct","recommendations","setRecommendations","displayEditForm","setDisplayEditForm","fetchDetails","res","fetch","data","json","handleRecommendationClick","clickedId","otherIds","filter","rec","id","map","method","headers","body","JSON","stringify","current_product_id","clicked_product_id","other_product_ids","deleteProduct","err","console","error","style","padding","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","isConfirmed","window","confirm","name","description","category","tags","t","join","mode","onClose","onSave","_c","$RefreshReg$"],"sources":["D:/projects/ProductCatalog/frontend/src/components/ProductDetail.js"],"sourcesContent":["/**\r\n * Component that displays the product details page. This component also displays\r\n * 3 recommended products for the current product being viewed, and clicking on\r\n * any of the recommendations will take you to the corresponding product's details page,\r\n * and update product similarities.\r\n * \r\n * @component\r\n */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport ProductForm from \"./ProductForm\";\r\n\r\nexport default function ProductDetail({ productId, onBack, onSelectRecommendation }) {\r\n    const [product, setProduct] = useState(null);\r\n    const [recommendations, setRecommendations] = useState([]);\r\n    const [displayEditForm, setDisplayEditForm] = useState(false);\r\n\r\n    // fetches a product's details along with its recommendations\r\n    async function fetchDetails() {\r\n        const res = await fetch(`/products/${productId}/?raw=0`);\r\n        const data = await res.json();\r\n        setProduct(data.product);\r\n        setRecommendations(data.recommendations);\r\n    }\r\n\r\n    // fetch product details on mount, unless productId is null\r\n    useEffect(() => {\r\n        if (productId) {\r\n            fetchDetails();\r\n        } else {\r\n            setProduct(null);\r\n        }\r\n    }, [productId]);\r\n\r\n    // Updates similarity scores, then loads the product details for the\r\n    // recommended product that was just clicked on.\r\n    const handleRecommendationClick = async (clickedId) => {\r\n        const otherIds = recommendations\r\n            .filter((rec) => rec.id !== clickedId)\r\n            .map((rec) => rec.id);\r\n\r\n        await fetch(\"/similarity/update/\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n                current_product_id: productId,\r\n                clicked_product_id: clickedId,\r\n                other_product_ids: otherIds,\r\n            }),\r\n        });\r\n\r\n        onSelectRecommendation(clickedId);\r\n    };\r\n\r\n    // Handler for product deletion\r\n    const deleteProduct = async (productId) => {\r\n        try {\r\n            const res = await fetch(`/products/${productId}/delete/`, {\r\n                method: \"DELETE\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n            });\r\n        } catch (err) {\r\n            console.error(`Error deleting product ${productId}`)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div style={{ padding: 20 }}>\r\n            <button onClick={onBack}>← Back</button>\r\n            <button\r\n                onClick={() => {\r\n                    setDisplayEditForm(true);\r\n                }}\r\n                style={{ marginLeft: 10 }}\r\n            >\r\n                Edit\r\n            </button>\r\n            <button\r\n                onClick={async () => {\r\n                    const isConfirmed = window.confirm(`Are you sure you want to delete the product: ${product.name}?`);\r\n                    if (isConfirmed) {\r\n                        await deleteProduct(productId);\r\n                        onBack();\r\n                    }\r\n                }}\r\n                style={{ marginLeft: 10 }}\r\n            >\r\n                Delete\r\n            </button>\r\n            {product ? (\r\n                <>\r\n                    <h2>{product.name}</h2>\r\n                    <p>{product.description}</p>\r\n                    <p><strong>Category:</strong> {product.category.name}</p>\r\n                    <p><strong>Tags:</strong> {product.tags.map((t) => t.name).join(\", \")}</p>\r\n\r\n                    <h3>Recommended Products</h3>\r\n                    <ul>\r\n                        {recommendations.map((rec) => (\r\n                            <li key={rec.id}>\r\n                                <button onClick={() => handleRecommendationClick(rec.id)}>\r\n                                    {rec.name}\r\n                                </button>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                </>\r\n            ) : (\r\n                <p>Loading...</p>\r\n            )}\r\n            {displayEditForm && productId && (\r\n                <ProductForm\r\n                    mode={\"edit\"}\r\n                    productId={productId}\r\n                    onClose={() => {\r\n                        setDisplayEditForm(false);\r\n                    }}\r\n                    onSave={() => {\r\n                        setDisplayEditForm(false);\r\n                        fetchDetails();\r\n                    }}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}